#!/usr/bin/env ruby
require 'rack'
require 'rack/directory'
require 'slop'

opts = Slop.parse!(ARGV){
  banner "usage: serve_dir [DIR] [OPTIONS]"
  on :p, :port, 'http port (default: 8181)'
  on :h, :help do
    puts self.help
    exit
  end
}

dir = File.expand_path(ARGV[0] || Dir.pwd)

app = Rack::Builder.app{
  use Rack::CommonLogger
  use Rack::ShowExceptions
  run Rack::Directory.new(dir)
}

puts "Open http://localhost:8181/"
Rack::Server.start(
  :app => app,
  :Port => (opts[:port] || 8181)
  )
